{include file="posts/header" /}

    <div class="admin-content-body">
      
        <div class="am-cf am-padding am-padding-bottom-0">
          <div class="am-fl am-cf">
            <strong class="am-text-primary am-text-lg">编辑</strong> /
            <small>edit</small>
          </div>
        </div>

        <hr>
        <form class="am-form am-form-inline"  id="edit-form" >
          <div class="am-tabs am-margin" data-am-tabs>
            <ul class="am-tabs-nav am-nav am-nav-tabs">
              <li class="am-active"><a href="#tab1">基本信息</a></li>
              <li><a href="#tab2">详细描述</a></li>
            </ul>

            <div class="am-tabs-bd">
              <div class="am-tab-panel am-fade am-in am-active" id="tab1">

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">布局名称</div>
                  <div class="am-u-sm-8 am-u-md-10">
                    <select data-am-selected="{btnSize: 'sm'}">
                      <option value="option1">选项一...</option>
                      <option value="option2">选项二.....</option>
                      <option value="option3">选项三........</option>
                    </select>
                  </div>
                </div>

                <div class="am-g am-margin-top-sm">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">文章分类</div>
                  <div class="am-u-sm-8 am-u-md-2 am-u-end col-end">
                    <input id="categories" name="categories" type="text" class="am-input-sm" value="{$posts.categories}">
                  </div>
                </div>

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">文章标签</div>
                  <div class="am-u-sm-8 am-u-md-10">
                    <input id="tags" name="tags" type="text" class="am-input-sm" value="{$posts.tags}" data-role="tagsinput" />
                  </div>
                </div>

                

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">发布日期</div>
                  <div class="am-u-sm-8 am-u-md-10">
                    
                      <div class="am-form-group am-form-icon">
                        <i class="am-icon-calendar"></i>
                        <input type="text" name="date" class="am-form-field am-input-sm" value="{$posts.date}" id="datetimepicker">
                      </div>

                  </div>
                </div>

                <div class="am-g am-margin-top">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">显示状态</div>
                  <div class="am-u-sm-8 am-u-md-10">
                    <div class="am-btn-group" data-am-button>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="status" id="option1"> 正常
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="status" id="option2"> 待审核
                      </label>
                      <label class="am-btn am-btn-default am-btn-xs">
                        <input type="radio" name="status" id="option3"> 不显示
                      </label>
                    </div>
                  </div>
                </div>

                <div class="am-g am-margin-top-sm">
                  <div class="am-u-sm-4 am-u-md-2 am-text-right">页面摘要</div>
                  <div class="am-u-sm-8 am-u-md-4 am-u-end">
                    <textarea rows="4" name="excerpt"></textarea>
                  </div>
                </div>

              </div>

              <div class="am-tab-panel am-fade" id="tab2">
                  <div class="am-g am-margin-top">
                      <input type="text" name="title" class="am-input-sm" value="{$posts.title}" placeholder="输入标题">
                      <input type="hidden" name="id" value="{$posts.id}" >
                      <input type="hidden" name="_id" value="{$posts._id}" >
                  </div>

                  <div class="am-g am-margin-top-sm">
                    <div class="am-u-sm-12" id="editormd">
                      <textarea style="display:none;" name="content">{$posts.content}</textarea>
                    </div>
                  </div>

              </div>

            </div>
          </div>

          <div class="am-margin">
            <button type="submit" class="am-btn am-btn-primary am-btn-xs" data-am-modal="{target: '#loading-modal'}">提交保存</button>
            <button type="button" class="am-btn am-btn-primary am-btn-xs">放弃保存</button>
          </div>
        </form>
    </div>

    {include file="posts/footer" /}
<script>
var _id = '{$posts._id}';
var id = '{$posts.id}';
// $('#tags').val()
// "Amsterdam,Washington,Sydney,Beijing,Cairo"

// $('#tags').tagsinput('items')
// ["Amsterdam", "Washington", "Sydney", "Beijing", "Cairo"]

$(function() {
  $('#datetimepicker').datetimepicker({
    language:  'zh-CN',
    format: 'yyyy-mm-dd hh:ii:ss'
  });
  var editor = editormd("editormd", {
      width   : "100%",
      height  : 600,
      path : "/js/editormd/"
  });
  var $form = $('#edit-form');
  var $modal = $('#loading-modal');

  $form.validator({
    submit: function() {
      var formValidity = this.isFormValid();
      if( formValidity == false ){
          $modal.modal('close');
          return false;
      }
      var data = $form.serialize();

      $.ajax({
        type: "POST",
        url: "/ajax/posts/"+_id,
        dataType: "json",
        data:{data:data},
        beforeSend:function(){

        },
        success: function(res){
            if ( res.code == 200 && res.data != '') {
                // location.reload()
            }else{
                // $modal.modal('close');
            }
        }
      });
      
      return false;
    }
  });
});

</script>
</html>
